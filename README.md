# README
В данном файле представлено описание функций, реализованных в файлах репозитория, используемых для моделирования в рамках ВКР.

## Перечень используемых пакетов:

- ggplot2 --- пакет, предоставляющий средства визуализации данных,
- matrixStats --- пакет, который предоставляет функцию weighted.median, вычисляющую взвешенную медиану оптимальным образом,
- permute --- пакет, реализующий случайные перестановки,
- poisson --- пакет, реализующий моделирования пуассоновского процесса.


## main_script.R
Основной файл для моделирований, относящихся к статистике, построенной на условной медиане, и её сравнения с аналогичной, построенной на условном матожидании.

- KE_mean --- функция вычисляет оценку условного матожидания Надарая-Уотсона в точке $x$. В ней же реализован вариант оценивания на краях носителя плотности.
- KE_mean.derivx --- функция вычисляет оценки производной условного матожидания Надарая-Уотсона в точке $x$.
- KE_median --- функция вычисляет оценку условной медианы Надарая-Уотсона в точке $x$. В ней же реализован вариант оценивания на краях носителя плотности.
- KE_cond.pmf --- функция вычисляет оценку плотности условного распределения в точке $(x,y)$. В ней же реализован вариант оценивания на краях носителя плотности.
- KE_cond.cdf --- функция вычисляет оценку функции распределения условного распределения в точке $(x,y)$. В ней же реализован вариант оценивания на краях носителя плотности.
- KE_cond.cdf.derivx --- функция вычисляет оценку производной функции распределения условного распределения в точке $(x,y)$ по аргументу $x$.
- stat.correction --- функция вычисляет поправку $B(P)$ для статистики $T_n$, построенной на условной медиане.
- stat.correction.mean --- функция вычисляет поправку $B(P)$ для статистики $T_n$, построенной на условном матожидании.
- KDE --- функция реализует ядерную оценку плотности в точке $x$. В ней же реализован вариант оценивания на краях носителя плотности.
- KE_var --- функция реализует оценку предельной дисперсии для статистики с условной медианой.

## median_graphs.R
Код в этом файле реализует моделирование статистики $T_n$, построенной на условной медиане, для последующего вычисления оценки дисперсии, построения гистограмм значений статистики и построения таблицы оценок вероятности ошибки первого рода.

Функция variance.test.size.simulation возвращает наборы значений статистики и оценки её дисперсии при объемах выборки вплоть до $n$ с числом повторов испытания $m$ . Параметры $q, d1, d2$ позволяют контролировать доли объектов в смеси распределений и условную дисперсию этих компонент. Для наглядности процесса моделирования, эта функция дополнительно отображает шкалу прогресса.

## norm_var_test.R
Код в этом файле реализует моделирование статистики $T_n$, построенной на условной медиане и условном матожидании, для последующего вычисления оценки дисперсии для демонстрации робастности первого варианта в случае нормального шума. 

Функция robustness.normnoise.simulation возвращает наборы оценки дисперсии статистик при объёмах выборки вплоть до $n$ с числом повторов испытания $m$. Параметры $q, d$ позволяют контролировать уровень шума и его дисперсию. Для наглядности процесса моделирования, эта функция дополнительно отображает шкалу прогресса.

## cauchy_var_test.R
Код в этом файле реализует моделирование статистики $T_n$, построенной на условной медиане и условном матожидании, для последующего вычисления оценки дисперсии для демонстрации робастности первого варианта в случае шума Коши. 

Функция robustness.cauchynoise.simulation возвращает наборы оценки дисперсии статистик при объёмах выборки вплоть до $n$ с числом повторов испытания $m$. Параметр $q$ позволяет контролировать уровень шума. Для наглядности процесса моделирования, эта функция дополнительно отображает шкалу прогресса.

## median_permtest.R
Код в этом файле реализует моделирование перестановочных критериев со статистиками $T_n$ и $S_n$ с условной медианой в конструкции.

Функция permutation.test реализует двухсторонний перестановочный критерий с заданным числом случайных перестановок.

Функция median.permtest.simulation возвращает набор результатов проверки гипотезы о разрывности условной медианы в нуле для этих двух критериев и обычного t-критерия при различных значений ширины окна.

## pois_script.R
Основной файл для моделирования, относящегося к статистике критерия проверки гипотезы разрывности плотности интенсивности пуассоновского процесса.

- intensity --- функция плотности интенсивности, рассматриваемая в моделировании
- intensity.discontinuity.KE --- функция вычисляет оценку разрыва плотности интенсивности в момент времени $x$

## pois_vartest.R
Код в этом файле реализует моделирование статистики $T_n$ критерия проверки разрывности плотности интенсивности для последующего вычисления оценки её дисперсии, построения гистограмм значений статистики и построения оценок вероятности ошибки первого рода.

Функция variance.test.size.simulation возвращает наборы значений статистики и оценки её дисперсии при числе реализаций процесса вплоть до $n$ с числом повторов испытания $m$ .
